# π“ TCP 3 & 4 way handshake


### TCP : _μ—°κ²° μ§€ν–¥ν• ν”„λ΅ν† μ½_ 
μ¥μΉλ“¤ μ‚¬μ΄μ— λ…Όλ¦¬μ μΈ μ ‘μ† μ„±λ¦½μ„ μ„ν•΄
μ‹ λΆ°μ„±μ„ λ³΄μ¥ν•λ” μ—°κ²°ν• μ„λΉ„μ¤

- μ „μ†΅λλ” λ°μ΄ν„°μ μ‹ λΆ°μ„± λ³΄μ¥ (νλ¦„ μ μ–΄, νΌμ΅ μ μ–΄, μ¤λ¥ μ μ–΄)
- κ°€μƒ νμ„ μ„ λ§λ“¤μ–΄ μ‹ λΆ°μ„±μ„ λ³΄μ¥
- νμΌμ „μ†΅μ— μ£Όλ΅ μ‚¬μ©
 
 
## π TCP 3 way handshake : _3λ²μ μ—°κ²° ν™•μΈ λ°©μ‹_

TCP ν†µμ‹ μ„ μ΄μ©ν• λ°μ΄ν„° μ „μ†΅μ„ μ„ν•΄  
**λ„¤νΈμ›ν¬ μ—°κ²°μ„ μ„¤μ •(Connection Establish)** ν•λ” κ³Όμ •
 
 
π‘ΈA β†’β†’ π¤΄B : λ‚΄ λ§ λ“¤λ ¤?  
π‘ΈA β†β† π¤΄B : μ λ“¤λ ¤. λ‚΄ λ§μ€ λ“¤λ ¤?  
π‘ΈA β†’β†’ π¤΄B : μ λ“¤λ ¤!  


![image](https://user-images.githubusercontent.com/63834758/218760424-e670a103-474e-4bc8-97dd-f92ae604857e.png)

 

 

### SYN (synchronize sequence numbers)
μ—°κ²° ν™•μΈμ„ μ„ν•΄ λ³΄λ‚΄λ” λ¬΄μ‘μ„μ μ«μκ°’ (λ‚΄ λ§ μ λ“¤λ ¤?)
  
### ACK (acknowledgements)
Client νΉμ€ Serverλ΅λ¶€ν„° λ°›μ€ SYNμ— 1μ„ λ”ν•΄ SYNμ„ μ λ°›μ•λ‹¤λ” ACK (μ λ“¤λ ¤)
 
### ISN (Initial sequence numbers)
Clientμ™€ Serverκ°€ κ°κ° μ²μμΌλ΅ μƒμ„±ν• SYN
 
 
 
## π TCPμ 3-way Handshaking κ³Όμ •
[STEP 1]  

Aν΄λΌμ΄μ–ΈνΈλ” Bμ„λ²„μ— μ ‘μ†μ„ μ”μ²­ν•λ” SYN ν¨ν‚·μ„ λ³΄λ‚Έλ‹¤.  
μ΄λ• Aν΄λΌμ΄μ–ΈνΈλ” SYN μ„ λ³΄λ‚΄κ³  SYN/ACK μ‘λ‹µμ„ κΈ°λ‹¤λ¦¬λ”SYN_SENT μƒνƒκ°€ λλ” κ²ƒμ΄λ‹¤.

 

[STEP 2] 

Bμ„λ²„λ” SYNμ”μ²­μ„ λ°›κ³  Aν΄λΌμ΄μ–ΈνΈμ—κ² μ”μ²­μ„ μλ½ν•λ‹¤λ” ACK μ™€ SYN flag κ°€ μ„¤μ •λ ν¨ν‚·μ„ λ°μ†΅ν•κ³  Aκ°€ λ‹¤μ‹ ACKμΌλ΅ μ‘λ‹µν•κΈ°λ¥Ό κΈ°λ‹¤λ¦°λ‹¤.  
μ΄λ• Bμ„λ²„λ” SYN_RECEIVED μƒνƒκ°€ λλ‹¤.

 

[STEP 3]  

Aν΄λΌμ΄μ–ΈνΈλ” Bμ„λ²„μ—κ² ACKμ„ λ³΄λ‚΄κ³  μ΄ν›„λ΅λ¶€ν„°λ” μ—°κ²°μ΄ μ΄λ£¨μ–΄μ§€κ³  λ°μ΄ν„°κ°€ μ¤κ°€κ² λλ”κ²ƒμ΄λ‹¤. μ΄λ•μ Bμ„λ²„ μƒνƒκ°€ ESTABLISHED μ΄λ‹¤.  
μ„μ™€ κ°™μ€ λ°©μ‹μΌλ΅ ν†µμ‹ ν•λ”κ²ƒμ΄ μ‹ λΆ°μ„± μλ” μ—°κ²°μ„ λ§Ίμ–΄ μ¤€λ‹¤λ” TCPμ 3 Way handshake λ°©μ‹μ΄λ‹¤.
 

 
 <hr>
 
 
 
 
μ΄λ²μ—” 4-way Handshaking μ— λ€ν•μ—¬ μ•μ•„λ³΄κ² μµλ‹λ‹¤.



## π TCP 4 way handshake : _4λ²μ ν™•μΈ κ³Όμ •_

3 way handshakeμ™€ λ°λ€λ΅  
**λ„¤νΈμ›ν¬ μ—°κ²°μ„ ν•΄μ (Connection Establish)** ν•λ” κ³Όμ •
 
 
![image](https://user-images.githubusercontent.com/63834758/218761735-b423ba60-1823-4227-9351-30ee29ef23fd.png)

 

 
π‘ΈA β†’β†’ π¤΄B : λ‚λ” λ‹¤ λ³΄λƒμ–΄. μ΄μ  λμ!  

π‘ΈA β†β† π¤΄B : μ•κ² μ–΄! μ μ‹λ§~  
π‘ΈA β†β† π¤΄B : λ‚λ„ λμ„κ²! 

π‘ΈA β†’β†’ π¤΄B : μ•κ² μ–΄!


### π TCPμ 4-way Handshaking κ³Όμ •
[STEP 1]  
ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°μ„ μΆ…λ£ν•κ² λ‹¤λ” FINν”λκ·Έλ¥Ό μ „μ†΅ν•λ‹¤.



[STEP 2]   
μ„λ²„λ” μΌλ‹¨ ν™•μΈλ©”μ‹μ§€λ¥Ό λ³΄λ‚΄κ³  μμ‹ μ ν†µμ‹ μ΄ λλ‚ λ•κΉμ§€ κΈ°λ‹¤λ¦¬λ”λ° μ΄ μƒνƒκ°€ TIME_WAITμƒνƒλ‹¤.

 

[STEP 3]  
μ„λ²„κ°€ ν†µμ‹ μ΄ λλ‚¬μΌλ©΄ μ—°κ²°μ΄ μΆ…λ£λμ—λ‹¤κ³  ν΄λΌμ΄μ–ΈνΈμ—κ² FINν”λκ·Έλ¥Ό μ „μ†΅ν•λ‹¤.

 

[STEP 4]  
ν΄λΌμ΄μ–ΈνΈλ” ν™•μΈν–λ‹¤λ” λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έλ‹¤.

<hr>  


### μ°Έκ³ μλ£
- [[λ„¤νΈμ›ν¬] TCP 3-way & 4-way handshakeλ€?](https://seongonion.tistory.com/74)
- [TCP 3 Way-Handshake & 4 Way-Handshake](https://mindnet.tistory.com/entry/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-22%ED%8E%B8-TCP-3-WayHandshake-4-WayHandshake)
- [[Network] TCP 3-way handshakingκ³Ό 4-way handshaking](https://gmlwjd9405.github.io/2018/09/19/tcp-connection.html)
