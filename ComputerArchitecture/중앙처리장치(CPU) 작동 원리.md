# 중앙처리장치(CPU) 작동 원리

## 1. 개념 및 구성

**CPU** : 프로그램을 실행하기 위해 메인 메모리에서 명령어를 인출하고 해독 및 실행한다.
'인간의 두뇌'에 해당되며 크게 연산, 제어, 저장 3가지로 구성된다.

1.  **연산** : 덧셈, 뺄셈, 곱셈 등의 산술 연산과 논리곱, 논리합, 부정 등의 논리 연산
    연산에 필요한 데이터를 레지스터에서 가져오고, 연산 결과를 다시 레지스터로 보내 저장한다.

2.  **제어** : 명령어를 순서대로 실행할 수 있도록 한다.
    주기억장치에서 프로그램 명령어를 꺼내 해독한 다음, 해독한 결과에 따라 명령어 실행에 필요한 제어 신호를 기억장치, 연산장치, 입출력장치로 보낸다.
    또한 이들 장치가 보낸 신호를 받아 다음에 수행할 동작을 결정한다.

3.  **저장** : 연산에 필요한 데이터, 연산 결과, 명령어 주소,명령어 코드 등을 임시로 저장한다.
    용도에 따라 범용 레지스터(연산에 필요한 데이터나 연산 결과를 임시로 저장)와 특수 목적 레지스터(특별한 용도로 사용하는 레지스터)로 구분된다.

> - **레지스터** : 고속 기억장치.<br>
>   　　 　　 명령어 주소, 코드, 연산에 필요한 데이터, 연산 결과 등을 임시로 저장한다 <br>
>   - 범용 레지스터 : 연산에 필요한 데이터나 연산 결과를 임시로 저장
>   - 특수목적 레지스터 : 특별할 용도로 사용하는 레지스터

<br>

### _**특수 목적 레지스터 중 중요한 것들**_

- **MAR(메모리 주소 레지스터)** : 읽기, 쓰기 연산을 수행할 주기억장치 주소 저장

- **PC(프로그램 카운터)** : 다음에 수행할 명령어 주소 저장

- **IR(명령어 레지스터)** : 현재 실행 중인 명령어 저장

- **MBR(메모리 버퍼 레지스터)** : 주기억장치에서 읽어온 데이터 or 저장할 데이터 임시 저장

- **AC(누산기)** : 연산 결과 임시 저장

<br>
<br>

## 2. CPU의 작동 원리

1. **주기억장치** : 입력장치에서 입력받은 데이터 또는 보조기억장치에 저장된 프로그램을 읽어온다.

2. **CPU** : 프로그램을 실행하기 위해 주기억장치에 저장된 프로그램 명령어와 데이터를 읽어와 처리하고 결과를 다시 주기억장치에 저장

3. **주기억장치** : 처리 결과를 보조기억장치에 저장하거나 출력장치로 보낸다.

4. **제어장치** : 1~3 과정에서 명령어가 순서대로 실행되도록 각 장치를 제어

<br>

> _**명령어 세트란?**_ <br>
> 　　 CPU가 실행할 명령어의 집합.<br>
> 　　 중앙처리장치에 따라 형식과 종류가 서로 다르다.<br>

- 명령어 = 연산 코드(Operation Code) + 피연산자(Operand)

- 연산 코드 : 실행할 연산

  - 연산기능 : 사칙연산, 시프트, 보수 등의 산술연산과 논리곱, 논리합, 부정 등의 논리연산을 수행한다.
  - 제어기능 : 조건 분기와 무조건 분기 등을 사용하여 명령어의 실행 순서를 제어한다.
  - 데이터 전달 기능 : 레지스터와 레지스터 사이, 레지스터와 주기억장치 사이에서 데이터를 전달한다.
  - 입출력 기능 : 프로그램과 데이터를 주기억장치에 전달하고, 연산 결과는 출력장치로 전달한다.
    <br>
    <br>

- 피연산자 : 필요한 데이터 or 데이터의 저장 위치
  <br>
  - 주소 : 기억장치 혹은 레지스터의 주소가 저장된다.
  - 숫자/문자 : 숫자는 정수, 고정 소수점 수, 부동 소수점 수 및 각각의 코드로 저장되고 문자는 아스키 코드로 저장된다.
  - 논리 데이터 : 참 또는 거짓을 표현할 때 사용하며 비트나 플래그 등으로 저장된다.

<hr>
중앙처리장치는 프로그램을 실행하기 위해 주기억장치에서 명령어를 순차적으로 인출하고, 해독 및 실행하는 과정을 반복한다.<br>
이렇게 한 번에 하나의 명령어를 주기억장치에서 인출하여 실행하는 데 필요한 일련의 활동을 **'명령어 사이클(Instruction Cycle)'** 이라고 말한다.

1. 인출 사이클 : 프로그램 카운터(PC) 값의 증가
2. 실행 사이클 : 인출사이클과 함께 항상 실행된다.
3. ( 간접 사이클, 인터럽트 사이클 : 주소 지정 방식이 필요할 때, 인터럽트 요구가 있을 때만 수행된다. )

<br>

- ### 인출 사이클에 의한 명령어 처리 과정
![image](https://user-images.githubusercontent.com/63834758/197391747-83b4ef05-1509-4221-b699-9c9c5d8174b8.png)

  > T0 : MAR <- PC <br>
  > T1 : MBR <- M[MAR], PC <- PC + 1 <br>
  > T2 : IR <- MBR <br>

  - PC에 저장된 주소를 MAR(메모리 주소 레지스터)로 전달
  - 저장된 내용을 토대로 주기억장치의 해당 주소에서 명령어 인출
  - 인출한 명령어를 MBR(메모리 버퍼 레지스터)에 저장
  - 다음 명령어를 인출하기 위해 PC값 증가
  - MBR(메모리 버퍼 레지스터)에 저장된 내용을 IR(명령어 레지스터)에 전달

<br>

- ### 실행 사이클에 의한 명령어 처리 과정
![image](https://user-images.githubusercontent.com/63834758/197391761-6f87b806-a40d-40b4-9490-8f6ddf623202.png)

  > T0 : MAR <- IR(Addr) <br>
  > T1 : MBR <- M[MAR] <br>
  > T2 : AC <- AC + MBR <br>

  - IR의 내용을 MAR로 전달한다
  - 메모리에 저장된 데이터 값을 MBR에 저장한다
  - AC(누산기)에 저장된 값에 ADD 연산을 실행한다
