# 📌 데드락(DeadLock)

✔️시스템 자원에 대한 요구가 뒤엉킨 상태 <br>
즉, **다른 프로세스가 점유하고 있는 자원을, 둘 이상의 프로세스가 서로 기다릴 때**
무한 대기에 빠지는 상황

![image](https://user-images.githubusercontent.com/63834758/208817670-965166cb-f1c5-4d90-907c-3109fc28c640.png)



<hr>

## 💻 발생 조건

✔️ 아래 4가지 모두 성립해야 데드락 발생 <br>
✔️ 하나라도 미성립 시 데드락 해결 가능

- **상호 배제**

  - 한 번에 한 프로세스가 해당 자원을 사용할 수 있음.
   

- **점유 대기**

  - 최소한 하나의 자원을 점유하면서, 다른 프로세스에 할당된 자원을 추가로 점유하기 위해 대기하는 프로세스가 존재할 때
   

- **비선점**

  - 타 프로세스에 이미 할당된 자원은 강제로 빼앗을 수 없음.
   

- **순환 대기**

  - 대기 프로세스의 집합이 순환 형태로 자원을 대기하고 있어야 함.




## 💻 해결법

### 🛠 데드락 예방(Prevention)


- _상호 배제 조건 방지_

> 여러 프로세스가 한 번에 공유 자원을 사용할 수 있게 한다.
> 그러나 추후 동기화 관련 문제가 발생할 수 있다.



- _점유 대기 조건 방지_

> 프로세스 실행에 필요한 모든 자원을 한꺼번에 요구하고 허용할 때까지 작업을 보류해서, 
> 나중에 또다른 자원을 점유하기 위한 대기 조건을 성립하지 않도록 한다.



- _비선점 조건 방지_

> 이미 다른 프로세스에게 할당된 자원이 선점권이 없다고 가정할 때, 
> 높은 우선순위의 프로세스가 해당 자원을 선점할 수 있도록 한다.



- _순환 대기 조건 방지_

> 자원을 순환 형태로 대기하지 않도록 일정한 한 쪽 방향으로만 자원을 요구할 수 있도록 한다.
> 다만 시스템의 처리량, 효율성 저하라는 단점이 발생할 수 있다.


<br>



### 🛠 데드락 회피(Avoidance)


<img src="https://user-images.githubusercontent.com/63834758/208813930-da3eeede-88b7-4bee-ac44-c9303ff563e0.png" width="30%" height="30%">



- 안정 상태(safe state) : 
프로세스들이 요청하는 모든 자원을, 
데드락 없이 모두에게 차례로 할당 가능

- 안전 순서(safe sequence) :
프로세스들에게 자원을 할당, 실행 및 종료 등의 작업 시
데드락이 발생하지 않는 순서를 찾을 수 있을 때



✔️ 은행원 알고리즘(Banker's Algorithm)
> 은행에서 모든 고객의 요구가 충족되도록 현금을 할당하는데서 유래함
> 프로세스가 자원을 요구할 때, 시스템은 자원을 할당한 후에도 안정 상태인지 사전에 검사하여 교착 상태 회피<br>
> 안정 상태면 자원 할당 / 아니면 다른 프로세스들 자원 해지까지 대기



<br>



### 🛠 데드락 탐지(Detection) 및 회복(Recovery)
시스템이 데드락 예방이나 회피법을 먼저 사용하지 않았을 때,
데드락 발생 시 회복하기 위해 알고리즘 사용

- **탐지 기법**
   - 은행원 알고리즘에서 했던 방식과 유사하게 현재 시스템의 자원 할당 상태를 가지고
     데드락 발생 여부를 파악한다.
   - 이 외 : 자원 할당 그래프를 통해 탐지하는 방법

- **회복 기법**
   - 탐지 기법으로 데드락을 발견했다면, 순환 대기에서 벗어나 데드락 회복 방법을 사용한다.

   - 단순히 프로세스를 1개 이상 중단시키기
      - **교착 상태에 빠진 모든 프로세스를 중단시키는 방법** : 계속 연산중이던 프로세스들도 모두 일시중단되어 부분 결과가 폐기될 수 있는 부작용이 발생할 수 있음
      - **프로세스를 하나씩 중단 시킬 때마다 탐지 알고리즘으로 데드락 탐지 & 회복하는 방법** : 매번 탐지 알고리즘 호출 및 수행하므로 부담이 되는 작업일 수 있음

   - 자원 선점하기
      - 프로세스에 할당된 자원을 선점해서, 교착 상태를 해결할 때까지 그 자원을 다른 프로세스에 할당해 주는 방법

<br>


<hr>

#### 참고

- [[운영체제] 데드락(Deadlock, 교착 상태)이란?](https://chanhuiseok.github.io/posts/cs-2/)
- [데드락 (DeadLock, 교착 상태)](https://gyoogle.dev/blog/computer-science/operating-system/DeadLock.html)

