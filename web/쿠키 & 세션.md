# :pushpin: 쿠키 & 세션


## :cookie: 쿠키

_클라이언트(로컬)에 저장되는 키와 값이 들어있는 작은 데이터 파일_

:heavy_check_mark:  쿠키의 특징

- 클라이언트에 저장되어 필요시 정보를 참조하거나 재사용할 수 있음
- 웹 환경에서는 클라이언트와 서버가 http 프로토콜을 이용해 통신
- 정해진 유효시간 내에서는 브라우저가 종료되어도 인증이 유지됨
- 클라이언트에 300개까지 쿠키 저장 가능, 하나의 도메인 당 20개의 값만 가질 수 있음, 하나의 쿠키값은 4KB까지 저장
- 예시) 쇼핑몰의 장바구니, "아이디와 비밀번호를 저장하시겠습니까?"

:heavy_check_mark: http 프로토콜의 특징
1. 비연결성 (Connectionless)
     - http는 tcp 연결을 맺고 요청을 보내면 서버는 응답을 보내고 **연결이 끊어짐**
2. 무상태 (Stateless)
     - http는 상태를 따로 저장하지 않음
     - 즉, 연결이 끊어지는 순간 **모든 상태 정보가 사라지게 됨**

:heavy_check_mark: 쿠키의 구조

- 이름 : 쿠키를 구별하는 이름
- 값 : 쿠키에 저장되는 값
- 유효시간 : 쿠키 유지시간
- 도메인 : 쿠키를 전송할 도메인
- 경로 : 쿠키를 전송할 요청 경로

:heavy_check_mark: 쿠키의 동작 방식

![image](https://user-images.githubusercontent.com/69101568/232634145-966876f8-7a8b-48be-a822-5d1e99acbcfe.png)

- 서버 : 클라이언트의 요청을 받고 정보를 담은 쿠키를 http 헤더에 **set-cookie** 옵션을 통해 전송
- 클라이언트 : 해당 쿠키를 쿠키 저장소에 저장


![image](https://user-images.githubusercontent.com/69101568/232634208-3c9f54c6-5fa2-4cfd-8040-eb2f1ed54500.png)

- 클라이언트 : 쿠키 저장소에서 쿠키를 꺼내 http 요청에 쿠키를 담아 전송
- 서버 : 쿠키를 읽어서 클라이언트 식별!

_만약 쿠키가 없었다면 할 때마다 로그인을 해야된다!!!_

---

## :computer: 세션

_일정 기간동안 같은 사용자로부터 들어오는 일련의 요구를 하나의 상태로 보고 그 상태를 일정하게 유지시키는 기술_

:heavy_check_mark:  세션의 특징
- 쿠키와는 다르게 서버 측에서 저장하고 관리
- 서버는 세션 ID를 이용해 클라이언트를 구분하며, 웹 브라우저가 서버에 접속해 브라우저를 종료할 때까지 세션 유지
- 사용자가 많아질수록 서버 메모리를 많이 차지
- 즉, 동접자 수가 많은 경우 서버에 과부하 -> 성능 저하


:heavy_check_mark: 세션의 동작 방식

![image](https://user-images.githubusercontent.com/69101568/232634718-9d83905f-5d72-4d04-aa4a-0c17d66dfc32.png)

- 서버 : 클라이언트의 요청을 받고 클라이언트의 정보를 담은 세션 생성, 세션 ID를 담은 쿠키를 생성하고 http 헤더에 set-cookie 옵션을 통해 전송
- 클라이언트 : 해당 쿠키를 쿠키 저장소에 저장


![image](https://user-images.githubusercontent.com/69101568/232634767-9c290866-dbaa-4268-846c-ce1c3cbdd4b2.png)

- 클라이언트 : 쿠키 저장소에서 쿠키를 꺼내 http 요청에 쿠키를 담아 전송
- 서버 : 쿠키를 읽어서 쿠키 안의 세션 ID를 이용해 클라이언트 식별

---

## :key: 쿠키와 세션의 차이

:heavy_check_mark:  저장 위치와 자원 사용
- 쿠키 : 클라이언트에 저장, 서버의 자원 사용 x
- 세션 : 서버에 저장, 서버의 자원 사용 o

:heavy_check_mark:  보안
- 쿠키 : 클라이언트에 저장하기때문에 변질 가능성이 있음
- 서버 : 쿠키를 이용해 세션 ID만 저장하고 서버에서 세션을 처리하기 때문에 비교적 보안이 좋음

:heavy_check_mark: 만료시간
- 쿠키 : 만료시간동안 파일로 저장되므로 브라우저가 종료돼도 정보가 남음
- 세션은 브라우저가 종료되면 만료시간에 상관없이 삭제됨

:heavy_check_mark: 속도
- 쿠키 : 쿠키 자체에 정보가 있어서 속도가 빠름
- 세션 : 서버에 정보가 있기때문에 비교적 속도가 느림

---

<br>

참고

- [[Web] 쿠키(Cookie)와 세션(Session)의 차이, 쿠키란? 세션이란?](https://code-lab1.tistory.com/298#recentEntries)
- [쿠키와 세션 개념](https://interconnection.tistory.com/74)