# π”° JWT (JSON Web Token)
- **JSON κ°μ²΄**λ¥Ό μ‚¬μ© π‘‰ ν† ν° μμ²΄μ— μ •λ³΄λ“¤μ„ μ €μ¥ν•κ³  μλ” **Web Token**
- μ μ €λ¥Ό μΈμ¦ & μ‹λ³„ν•κΈ° μ„ν• **ν† ν° κΈ°λ° μΈμ¦**

- κ³µκ°/κ°μΈ ν‚¤λ¥Ό μμΌλ΅ μ‚¬μ©ν•μ—¬ ν† ν°μ— μ„λ…ν•  κ²½μ°  
    μ΄ μ„λ…λ ν† ν°μ΄ μ •μƒμ μΈ ν† ν°μΈμ§€λ¥Ό μ„λ²„κ°€ ν™•μΈν•  μ μλ‹¤. (κ°μΈν‚¤λ¥Ό λ³΄μ ν• μ„λ²„)

<br>

## 1. ν•µμ‹¬ νΉμ§•
- ν† ν° μμ²΄μ— _μ‚¬μ©μμ κ¶ν• μ •λ³΄_ or _μ„λΉ„μ¤λ¥Ό μ‚¬μ©ν•κΈ° μ„ν• μ •λ³΄_ κ°€ ν¬ν•¨(Self-contained)λλ‹¤
- λ”°λΌμ„, ν† ν°μ— μ €μ¥λλ” μ •λ³΄ β†‘ = λ„¤νΈμ›ν¬ μ‚¬μ©λ‰ β†‘

<br>

## 2. JWTμ κµ¬μ΅°

- JWTλ” κ°κ°μ κµ¬μ„±μ”μ†κ°€ μ (.)μΌλ΅ κµ¬λ¶„μ΄ λμ–΄μμΌλ©° κµ¬μ„± μ”μ†λ” λ‹¤μκ³Ό κ°™λ‹¤.

![image](https://github.com/SeoYeonBae/CS_study/assets/63834758/16169a7d-e3c2-4377-b332-154b13f2c52b)


### 1οΈβƒ£ Header
![image](https://github.com/SeoYeonBae/CS_study/assets/63834758/5e0e9f79-477e-4818-868f-0443ee15e984)

- JWT ν† ν°μ—μ„ μ‚¬μ©ν•  νƒ€μ… & Signatureλ¥Ό ν•΄μ‹±ν•κΈ° μ„ν• ν•΄μ‹ μ•κ³ λ¦¬μ¦μ μΆ…λ¥λ¥Ό ν¬ν•¨
    - ν† ν° νƒ€μ…μ΄ JWTλΌλ” μλ―Έ
    - HS512 κ°μΈν‚¤ μ•κ³ λ¦¬μ¦μ„ μ μ©ν•μ—¬ μ•”νΈν™”ν–λ‹¤λ” μλ―Έ

### 2οΈβƒ£ Payload
![image](https://github.com/SeoYeonBae/CS_study/assets/63834758/dad42631-db13-4cad-a369-1fd60d6f4a63)

- μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ£Όκ³ λ°›λ”, μ¦‰ μ‹μ¤ν…μ—μ„ μ‹¤μ λ΅ μ‚¬μ©λλ” μ •λ³΄λ“¤μ„ ν¬ν•¨
- λ³΄ν†µ Claimμ΄λΌλ” μ‚¬μ©μ or ν† ν°μ— λ€ν• propertyλ¥Ό key-value ν•νƒλ΅ μ €μ¥
    - Claim : λ§ κ·Έλ€λ΅ ν† ν°μ—μ„ μ‚¬μ©ν•  μ •λ³΄μ μ΅°κ°
- ν‘μ¤€ μ¤ν™ μƒ keyμ μ΄λ¦„μ€ 3κΈ€μ ( ν† ν°μ— λ€ν• ν‘ν„ μ••μ¶•)
    - _iss (Issuer)_ : ν† ν° λ°κΈ‰μ
    - _sub (Subject)_ : ν† ν° μ λ© (μ‚¬μ©μμ— λ€ν• μ‹λ³„ κ°’)
    - _aud (Audience)_ : ν† ν° λ€μƒμ
    - _exp (Expiration Time)_ : ν† ν° λ§λ£ μ‹κ°„
    - _nbf (Not Before)_ : ν† ν° ν™μ„± λ‚ μ§ (μ΄ λ‚ μ§ μ΄μ „μ ν† ν°μ€ ν™μ„±ν™” λμ§€μ•μμ„ λ³΄μ¥)
    - _iat (Issued At)_ : ν† ν° λ°κΈ‰ μ‹κ°„
    - _jti (JWT Id)_ : JWT ν† ν° μ‹λ³„μ (issuerκ°€ μ—¬λΏμΌ λ• κµ¬λ¶„ν•κΈ° μ„ν• κ°’)

> μ΄λ ‡κ² μ •μλμ–΄ μλ” Claim μ¤ν™μ΄ μλ‹¤λ” κ²ƒμ΄μ§€,
> 
> κΌ­ μ΄ 7κ°€μ§€λ¥Ό λ¨λ‘ ν¬ν•¨ν•΄μ•Ό ν•λ” κ²ƒμ€ X
> 
> μƒν™©μ— λ”°λΌ ν•΄λ‹Ή μ„λ²„κ°€ κ°€μ Έμ•Όν•  μΈμ¦ μ²΄κ³„μ— λ”°λΌ μ‚¬μ©ν•λ©΄ λλ‹¤.

> ν‘μ¤€ μ¤ν™ μ™Έμ—λ„ ν•„μ”ν• μ •λ³΄λ¥Ό κ°λ°μκ°€ μ›ν•λ”λ€λ΅ μ¶”κ°€ κ°€λ¥
> 
> μμ‹ ) "token_type" : "access token"

- λ‹¤λ§ μ£Όμμ‚¬ν•­μ€ **Payloadμ— λ―Όκ°ν• μ •λ³΄λ¥Ό λ‹΄μ§€ μ•λ” κ²ƒμ΄λ‹¤.**
    - headerdμ™€ payloadλ” jsonμ΄ λ””μ½”λ”©λμ–΄μμ„ λΏ, νΉλ³„ν• μ•”νΈν™” X
    - κ·Έλ¬λ―€λ΅ λ‹¨μν** "μ‹λ³„ν•κΈ° μ„ν•" **μ •λ³΄λ§μ„ λ‹΄μ•„λ‘μ–΄μ•Ό ν•λ‹¤.
    - μ„λ²„μ—μ„ μƒμ„±ν• JWTλ¥Ό jwt.io μ‚¬μ΄νΈμ— λ„£κΈ°λ§ ν•΄λ„ μ•„λμ²λΌ μ •λ³΄λ¥Ό λ³Ό μ μλ‹¤.
    ![image](https://github.com/SeoYeonBae/CS_study/assets/63834758/c98f255d-554f-4865-a2da-c8608ae2c04c)

- header, payloadκ°€ μ‹λ³„κ°’λ§ μ΅΄μ¬ν•λ”λΌλ„ μ•”νΈν™”κ°€ ν•„μ”ν•μ§€ μ•μ€κ°€?
    - μ‚¬μ‹¤ ν•„μ”μ—†λ” ν–‰μ„μ΄λ‹¤. μ•”νΈν™” μμ²΄κ°€ λ§μ€ λ¦¬μ†μ¤λ¥Ό μ‚¬μ©ν•λ‹¤.
    - λ§¤ http μ”μ²­λ§λ‹¤ 1λ²μ λ³µνΈν™”κ°€ λ” μ¶”κ°€λλ” μ…μ΄κΈ° λ•λ¬Έμ΄λ‹¤.


### 3οΈβƒ£ Signature

![image](https://github.com/SeoYeonBae/CS_study/assets/63834758/9b0e9bab-f4f3-4464-9e0c-3069f902b665)

- κ°€μ¥ μ¤‘μ”ν• μ„λ…
- headerλ¥Ό λ””μ½”λ”©ν• κ°’, payloadλ¥Ό λ””μ½”λ”©ν• κ°’μ„ μ„ μ‚¬μ§„ μ²λΌ ν•©μΉκ³ ,  
μ΄λ¥Ό your-256-bit-secret μ¦‰, **μ„λ²„κ°€ κ°€μ§€κ³  μλ” κ°μΈν‚¤λ¥Ό κ°€μ§€κ³  μ•”νΈν™”λμ–΄μλ” μƒνƒ**μ΄λ‹¤.  
- λ”°λΌμ„ signatureλ” **μ„λ²„μ— μλ” κ°μΈν‚¤λ΅λ§ μ•”νΈν™”λ¥Ό ν’€ μ μμΌλ―€λ΅**  
λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈλ” μ„μλ΅ Signatureλ¥Ό λ³µνΈν™”ν•  μ μ—†λ‹¤.


> (1) JWT ν† ν°μ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„λ΅ μ”μ²­κ³Ό λ™μ‹μ— μ „λ‹¬ν•λ‹¤.
> 
> (2) μ„λ²„κ°€ κ°€μ§€κ³  μλ” κ°μΈν‚¤λ¥Ό κ°€μ§€κ³  Signatureλ¥Ό λ³µνΈν™”ν• λ‹¤μ 
> 
> (3) base64UrlEncode(header)κ°€ JWTμ heaerκ°’κ³Ό μΌμΉν• μ§€,  base64UrlEncode(payload) μ™€ μΌμΉν• μ§€ ν™•μΈν•μ—¬ <br>
> μΌμΉν•λ‹¤λ©΄ μΈμ¦μ„ ν—μ©ν•λ‹¤.
> 
> (4) λ§μ•½ ν΄λΌμ΄μ–ΈνΈκ°€ payloadμ— λ‹΄κΈ΄ μ‹λ³„μκ°€ λ³€μ΅°λ JWTλ΅ μ”μ²­μ„ ν•λ”λΌλ„  
μ„λ²„κ°€ μ• μ΄μ— λ°κΈ‰ν–λ Signature μ•μ payloadμ™€ λ‹¤λ¥΄κΈ° λ•λ¬Έμ— μΈμ¦μ΄ λ¶κ°€λ¥ν•΄μ§„λ‹¤.

<br>

## 3. JWT λ™μ‘ μ μ°¨


1οΈβƒ£ **ν΄λΌμ΄μ–ΈνΈ(μ‚¬μ©μ)** : ID, PWλ¥Ό ν†µν•΄ μ„λ²„μ— μΈμ¦ μ”μ²­(ex. λ΅κ·ΈμΈ)  
2οΈβƒ£ **μ„λ²„** : μ„λ…λ(Signed) JWTλ¥Ό μƒμ„±ν•μ—¬ ν΄λΌμ΄μ–ΈνΈλ΅ λ°ν™  
3οΈβƒ£ **ν΄λΌμ΄μ–ΈνΈ** : μ„λΉ„μ¤λ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄ μΈκ°€κ°€ ν•„μ”ν•  λ• μ„λ²„λ΅λ¶€ν„° λ°ν™λ°›μ€ JWTλ¥Ό HTTP ν—¤λ”μ— μ²¨λ¶€ν•μ—¬ μ”μ²­  
4οΈβƒ£ **μ„λ²„** : ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μμ‹ λ°›μ€ HTTP ν—¤λ”μ JWTλ¥Ό κ²€μ¦ν• ν›„, μ”μ²­μ„ μ²λ¦¬

<br>

## 4. μ¥μ 

- μ΄λ―Έ ν† ν° μμ²΄κ°€ μΈμ¦λ μ •λ³΄μ΄κΈ° λ•λ¬Έμ— μ„Έμ… μ €μ¥μ†μ™€ κ°™μ€ λ³„λ„μ μΈμ¦ μ €μ¥μ†κ°€ "ν•„μμ "μΌλ΅ ν•„μ”ν•μ§€ μ•λ‹¤.

- μ„Έμ…κ³Όλ” λ‹¤λ¥΄κ² ν΄λΌμ΄μ–ΈνΈμ μƒνƒλ¥Ό μ„λ²„κ°€ μ €μ¥ν•΄ λ‘μ§€ μ•μ•„λ„ λλ‹¤.

- signatureλ¥Ό κ³µν†µ ν‚¤ κ°μΈν‚¤ μ•”νΈν™”λ¥Ό ν†µν•΄ λ§‰μ•„λ‘μ—κΈ° λ•λ¬Έμ— λ°μ΄ν„°μ— λ€ν• λ³΄μ™„μ„± β†‘

- λ‹¤λ¥Έ μ„λΉ„μ¤μ— μ΄μ©ν•  μ μλ” κ³µν†µμ μΈ μ¤ν™μΌλ΅μ¨ μ‚¬μ© κ°€λ¥

<br>

## 5. μ”μ•½

stateful ν•΄μ•Ό ν•λ” μ„Έμ…μ λ‹¨μ μ„ λ³΄μ™„ν•κΈ° μ„ν•΄ λ§λ“¤μ–΄μ§„ JWTλ”  
λ³„λ„μ μ„Έμ… μ €μ¥μ†λ¥Ό κ°•μ ν•μ§€ μ•κΈ° λ•λ¬Έμ— stateless ν•μ—¬ ν™•μ¥μ„±μ΄ λ›°μ–΄λ‚κ³ ,  
signatureλ¥Ό ν†µν• λ³΄μ•μ„±κΉμ§€ κ°–μ¶”κ³  μλ‹¤.



<hr>

### μ°Έκ³ μλ£

- [JWT (Json Web Token) μ΄λ€?](https://velog.io/@corone_hi/JWT-Json-Web-Token-%EC%9D%B4%EB%9E%80)
- [JWT - Json Web Token](https://www.daleseo.com/jwt/)
